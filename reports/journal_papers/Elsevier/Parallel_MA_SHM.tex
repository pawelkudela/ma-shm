
%% 
%% Copyright 2007, 2008, 2009 Elsevier Ltd
%% 
%% This file is part of the 'Elsarticle Bundle'.
%% ---------------------------------------------
%% 
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%% 
%% The list of all files belonging to the 'Elsarticle Bundle' is
%% given in the file `manifest.txt'.
%% 
%% Template article for Elsevier's document class `elsarticle'
%% with harvard style bibliographic references
%% SP 2008/03/01

\documentclass[preprint,12pt]{elsarticle}

%% Use the option review to obtain double line spacing
%% \documentclass[authoryear,preprint,review,12pt]{elsarticle}

%% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
%% for a journal layout:
%% \documentclass[final,1p,times,authoryear]{elsarticle}
%% \documentclass[final,1p,times,twocolumn,authoryear]{elsarticle}
%% \documentclass[final,3p,times,authoryear]{elsarticle}
%% \documentclass[final,3p,times,twocolumn,authoryear]{elsarticle}
%% \documentclass[final,5p,times,authoryear]{elsarticle}
%% \documentclass[final,5p,times,twocolumn,authoryear]{elsarticle}

%% For including figures, graphicx.sty has been loaded in
%% elsarticle.cls. If you prefer to use the old commands
%% please give \usepackage{epsfig}

%% The amssymb package provides various useful mathematical symbols
\usepackage{amsmath,amssymb,bm}
\usepackage[dvips,colorlinks=true,citecolor=green]{hyperref}
%% my added packages
\usepackage{verbatim}
%\usepackage{breqn}
\newcommand{\ud}{\mathrm{d}}
\renewcommand{\vec}[1]{\mathbf{#1}}
\newcommand{\veca}[2]{\mathbf{#1}{#2}}
\renewcommand{\bm}[1]{\mathbf{#1}}
\newcommand{\bs}[1]{\boldsymbol{#1}}
%% The amsthm package provides extended theorem environments
%% \usepackage{amsthm}
%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers.
%% \usepackage{lineno}
\journal{NDT \& E International}
\begin{document}
	\begin{frontmatter}
		%% Title, authors and addresses
		%% use the tnoteref command within \title for footnotes;
		%% use the tnotetext command for theassociated footnote;
		%% use the fnref command within \author or \address for footnotes;
		%% use the fntext command for theassociated footnote;
		%% use the corref command within \author for corresponding author footnotes;
		%% use the cortext command for theassociated footnote;
		%% use the ead command for the email address,
		%% and the form \ead[url] for the home page:
		%% \title{Title\tnoteref{label1}}
		%% \tnotetext[label1]{}
		%% \author{Name\corref{cor1}\fnref{label2}}
		%% \ead{email address}
		%% \ead[url]{home page}
		%% \fntext[label2]{}
		%% \cortext[cor1]{}
		%% \address{Address\fnref{label3}}
		%% \fntext[label3]{}
		
		\title{Parallel spectral element method for model-assisted structural health monitoring}
		
		%% use optional labels to link authors explicitly to addresses:
		%% \author[label1,label2]{}
		\address[IFFM]{Institute of Fluid Flow Machinery, Polish Academy of Sciences, Poland}
		\address[GU]{Goethe University, Germany}
		
		\ead{pk@imp.gda.pl}
		\cortext[cor1]{Corresponding author}
		
		\author{Pawel Kudela\corref{cor1}\fnref{IFFM}}
		\author{Jochen Moll\fnref{GU}}
		\author{Piotr Fiborek \fnref{IFFM}}
		
		
		\begin{abstract}
			%% Text of abstract
			Parallel implementation of spectral element method is developed in which flat shell spectral elements are utilized for domain representation. The implementation is realised by using Matlab Parallel Computing Toolbox and optimized for Graphics Processing Unit (GPU) computation. In this way, considerable computation speedup can be achieved in comparison to computation on conventional processors. The method was tested on experimental data set available on Open Guided Waves platform. Qualitative comparison was performed on full wave field data, whereas quantitative comparison was made directly on signal of propagating Lamb waves registered by piezoelectric transducers. In both cases, good agreement between numerical and experimental results was achieved. The proposed method is particularly useful for structural health monitoring algorithms in which signal parameters are required such as wave velocity dependence on angle of propagation. Moreover, it enables model-assisted damage size estimation in which damage influence curve is estimated based on large numerical data set and sparse experimental data. Due to relatively short computation time, large data sets can be generated and used for machine learning or other soft computing methods opening up new possibilities in health monitoring of structures.
		\end{abstract}
		
		\begin{keyword}
			%% keywords here, in the form: keyword \sep keyword
			Spectral element method \sep Guided waves \sep CFRP plates \sep interface elements \sep Lagrange multipliers.
			%% PACS codes here, in the form: \PACS code \sep code
			
			%% MSC codes here, in the form: \MSC code \sep code
			%% or \MSC[2008] code \sep code (2000 is the default)
			
		\end{keyword}
		
	\end{frontmatter}
	
	%% \linenumbers
	
	%% main text
	\section{Introduction}
	\section{Flat shell spectral element}
	Spectral finite element for flat shell modelling is based on Mindlin-Reissner first order shear deformation theory. It has 36 nodes and 5 degrees of freedom in each node: displacement components $u_0$ and $v_0$ in neutral plane along $x$ and $y$ axis, respectively, transverse displacement $w_0$ and two independent rotations of cross-section $\varphi_x(x,y)$ and $\varphi_y(x,y)$. The displacement field can be written as:
	\begin{equation}
	\begin{split}
	& u(x,y,z)=u_0(x,y) - \varphi_x(x,y) \cdot z\\
	& v(x,y,z)=v_0(x,y) - \varphi_y(x,y) \cdot z\\
	& w(x,y,z)=w_0(x,y) \label{eq:delam_platedispl}
	\end{split}
	\end{equation}
	The strain field assuming small deformations is:
	\begin{equation}
	\begin{split}
	& \varepsilon_x(x,y,z)= \frac{\partial u_0}{\partial x} - \frac{\partial \varphi_x}{\partial x} \cdot z\\
	& \varepsilon_y(x,y,z)=\frac{\partial v_0}{\partial y} - \frac{\partial \varphi_y}{\partial y} \cdot z\\
	& \gamma_{xy}(x,y,z)= \frac{\partial u_0}{\partial y} +  \frac{\partial v_0}{\partial x} - \left( \frac{\partial \varphi_x}{\partial y} + \frac{\partial \varphi_y}{\partial x}\right)\cdot z\\
	& \gamma_{yz}(x,y,z)= \frac{\partial w_0}{\partial y} - \varphi_y\\
	& \gamma_{zx}(x,y,z)= \frac{\partial w_0}{\partial x} - \varphi_x 
	\label{eq:delam_platestrains}
	\end{split}
	\end{equation}
	Assuming approximation of displacement field within the element:
	\begin{equation}
	\left[\begin{array}{l} u_0^e(\xi, \eta) \\ \varphi_x^e(\xi, \eta)\\ v_0^e(\xi, \eta) \\ \varphi_y^e(\xi, \eta)\\ w_0^e(\xi, \eta)\\ \end{array}\right] = \bm{N}^e \vec{\hat{u}}^e = \sum \limits_{j=1}^{6} \sum \limits_{i=1}^{6} N^e_i(\xi) N^e_i(\eta)\, \bm{I} \left[ \begin{array}{l} {\hat{u}_0}^e(\xi_i,\eta_j)\\\hat{\varphi}_x^e(\xi_i,\eta_j)\\{\hat{v}_0}^e(\xi_i,\eta_j) \\\hat{\varphi}_y^e(\xi_i,\eta_j) \\ \hat{w}_0^e(\xi_i,\eta_j)\end{array} \right]\label{eq:delam_plateaproxim}
	\end{equation}  
	where $\bm{N}^e$ are shape functions, $\vec{\hat{u}}^e$ are nodal degrees of freedom in the element, $\bm{I}$ is the unit matrix of the size 5x5, and assuming approximation of geometry of the element:	\begin{equation}
	\left[\begin{array}{l} x_0^e(\xi, \eta) \\ y_0^e(\xi, \eta)  \end{array}\right] = \sum \limits_{j=1}^{6} \sum \limits_{i=1}^{6} N^e_i(\xi) N^e_j(\eta)\, \left[ \begin{array}{l} x^e(\xi_i,\eta_j)\\y^e(\xi_i,\eta_j)\end{array} \right]\label{eq:delam_plategeom}
	\end{equation}  
	and substituting into eq.~(\ref{eq:delam_platestrains}) one can obtain approximated strains: 
	\begin{equation}
	\bs{\varepsilon}^e(\xi,\eta) = 	\vec{B}^e \vec{\hat{u}}^e \label{eq:delam_plate_relat}
	\end{equation} 
	where $	\vec{B}^e$ is the matrix relating strains with nodal displacements calculated as:
	\begin{equation}
	\begin{split}
	& \vec{B}^e =  \bm{L} \, \bm{N}^e\!(\xi,\eta) \\ 
	& \bm{L} = \left[\begin{array}{ccccc} \frac{\partial}{\partial x} & -z\, \frac{\partial}{\partial x} & 0 & 0 & 0 \\[4pt]
	0&0&\frac{\partial}{\partial y}&-z\, \frac{\partial}{\partial y}&0\\[4pt]
	\frac{\partial}{\partial y} &-z\,\frac{\partial}{\partial y} & \frac{\partial}{\partial x} &-z\,  \frac{\partial}{\partial x} &0 \\[4pt]
	0&0&0&-1&\frac{\partial}{\partial y} \\[4pt]
	0&-1&0&0&\frac{\partial}{\partial x} \end{array} \right], \quad \left[\begin{array}{c}\frac{\partial }{\partial x}\\[4pt] \frac{\partial }{\partial y}\end{array}\right] = \vec{J}^{-1} \left[\begin{array}{c}\frac{\partial }{\partial \xi}\\[4pt] \frac{\partial }{\partial \eta}\end{array}\right]
	\label{eq:delam_plate_disp_strains}
	\end{split}
	\end{equation} 
	where $\vec{J}$ is Jacobi matrix which as a form:
	\begin{equation}
	\vec{J} = \Bigg[ \begin{array}{cc}\frac{\partial x}{\partial \xi}&\frac{\partial y}{\partial \xi}\\[4pt]
	\frac{\partial x}{\partial \eta}&\frac{\partial y}{\partial \eta}\end{array} \Bigg].
	\label{eq:Jacobi2D}
	\end{equation}
	Elemental mass matrix and stiffness matrix are calculated numerically by using Gaussa-Lobatto-Legendre (GLL) integration rule:
	\begin{equation}
	\begin{split}
	\bm{m}^e &= \int \limits_{\Omega_e} \big[\bm{N}^e\!(x,y)\big]^{\!T} \bm{R}^e\!(x,y) \, \bm{N}^e\!(x,y) \; \ud \Omega_e \\
	&	\approx \sum \limits_{j=1}^{6} \sum \limits_{i=1}^{6} w_i\, w_j \, \big[\bm{N}^e\!(\xi_i, \eta_j)\big]^{\!T} \bm{R}^e\!(\xi_i, \eta_j)	\,
	\bm{N}^e\!(\xi_i,\eta_j) \, \det(\vec{J}^e)\label{eq:delam_plate_mass}
	\end{split}
	\end{equation} 
	\begin{equation}
	\begin{split}
	\bm{k}^e &= \int \limits_{V_e} \big[\vec{B}^e\!(x,y)\big]^{\!T} \vec{D}^e \!(x,y)\, \vec{B}^e\!(x,y) \; \ud V_e \\
	& \approx \sum \limits_{j=1}^{6} \sum \limits_{i=1}^{6} w_i\, w_j\! \int \limits_{-h/2}\limits^{h/2} \big[\vec{B}^e\!(\xi_i,\eta_j)\big]^{\!T}\, \bm{\overline Q}^e\!(\xi_i,\eta_j) \, \vec{B}^e\!(\xi_i,\eta_j) \, \det(\vec{J}^e)\, \ud z\\
	&=\sum \limits_{j=1}^{6} \sum \limits_{i=1}^{6} w_i\, w_j \sum \limits_{k=1}^{N} \int_{h_{k-1}}^{h_k} \big[\vec{B}^e\!(\xi_i,\eta_j)\big]^{\!T} \bm{\overline Q}_k^e\!(\xi_i,\eta_j) \, \vec{B}^e\!(\xi_i,\eta_j) \, \det(\vec{J}^e)\, \ud z \label{eq:dealm_plate_stiffness}
	\end{split}
	\end{equation} 
	The quadrature weight $w_i > 0$, which are independent form the element, are defined by:
	\begin{equation}
	w_i = \frac{2}{m(m-1)\big[ P_{m-1}\!(\xi_i) \big]^2}\; , \quad i \in 1,\ldots, m \label{eq:weights}
	\end{equation}
	where $P_{m-1}$ is Legendre polynomial of order $m-1$, $m=6$ for 6~$\times$~6 nodes flat shell spectral element.
	Matrix $\bm{R}^e$ from eq. (\ref{eq:delam_plate_mass}) is calculated as:
	\begin{equation}
	\begin{split}
	&\bm{R}^e = \left[\begin{array}{ccccc} I_0 & 0&0&0&0 \\ 0& I_2&0&0&0 \\0&0&I_0&0&0\\0&0&0&I_2&0\\ 0&0&0&0&I_0 \end{array}\right]\\
	&I_0 =  \sum \limits_{k=1}\limits^{N} \rho_k \,(h_{k-1} - h_k),\\ 
	& I_2 =  \sum \limits_{k=1}\limits^{N} \rho_k \,(h_{k-1}^3 - h_k^3)/3,
	\label{eq:delam_plate_mass_dens}
	\end{split}
	\end{equation}
	where $N$ -- the number of composite layers, $\rho_k$ -- mass density of $k$-th layer, $h_k$ -- the distance from the neutral surface to the top surface of the $k$-th layer, $h_{k-1}$ -- the distance from the neutral surface to the bottom surface of the $k$-th layer.
	In the current implementation it is assumed that damping matrix is proportional to the mass matrix.
	The matrix $\bm{\overline Q}_k^e$ from eq. (\ref{eq:dealm_plate_stiffness}) for $k$-th composite layer is calculated as:
	\begin{equation}
	\bm{\overline Q}_k^e = \left[\begin{array}{ccccc} \overline{Q}_{11} & \overline{Q}_{12}& \overline{Q}_{16} & 0&0\\[2pt]
	\overline{Q}_{12}& \overline{Q}_{22} & \overline{Q}_{26}& 0&0\\\overline{Q}_{16}&\overline{Q}_{26}&\overline{Q}_{66}&0&0\\[2pt]
	0& 0 &0&\overline{Q}_{44}& \overline{Q}_{45}\\[2pt]
	0&0&0&\overline{Q}_{45}&\overline{Q}_{55}\end{array}\right] \label{eq:dealm_plate_stf}
	\end{equation}
	The components of matrix $\bm{\overline Q}$ can be found in the literature~[{sierakowski89-composite}].
	It should be noted that in general both mass density $\rho_k$ as well as elastic constants $\bm{\overline Q}_k^e$ can have arbitrary values at GLL points but for simplicity it is assumed that they are constant within $k$-th layer. Integral over thickness of layers in eq.~\ref{eq:dealm_plate_stiffness} is evaluated analytically which leads to the following constants:
	\begin{equation}
	\begin{split}
	& A_{ij} =  \sum \limits_{k=1}\limits^{N} (\overline{Q}_k)_{ij} \,(h_{k-1} - h_k),\quad i,j = 1,2,6,\\
	& A_{ij} =  \sum \limits_{k=1}\limits^{N} (\overline{Q}_k)_{ij} \,5/4 (h_{k-1} - h_k - 4/3 (h_{k-1}^3 - h_k^3)/h^2 ),\quad i,j = 4,5,\\
	& B_{ij} = \sum \limits_{k=1}\limits^{N}(\overline{Q}_k)_{ij} \,(h_{k-1}^2 - h_k^2)/2, \quad i,j = 1,2,6,\\
	& D_{ij} = \sum \limits_{k=1}\limits^{N}(\overline{Q}_k)_{ij} \,(h_{k-1}^3 - h_k^3)/3, \quad i,j = 1,2,6.
	\end{split}
	\end{equation}
	\section{Implementation by using Matlab Parallel Computing Toolbox}
	In classic finite element approach elemental matrices are assembled to form equation of motion:
	\begin{equation}
	\bm{M} \vec{\ddot{U}} + \bm{C} \vec{\dot{U}} + \bm{K} \vec{U} = \vec{F} \label{eq:motion}
	\end{equation}  
	where $ \bm{M} $ is the global mass (inertia) matrix, $ \bm{K} $ is the global stiffness matrix,  $\bm{C} $ is the global damping matrix, $\vec{U}$ is the vector of global degrees of freedom and~$\vec{F}$ is the vector of the time dependent excitation (in this particular case the vector of equivalent piezoelectric forces). The most efficient way to solve the eq.~\ref{eq:motion} is by using explicit integration scheme. Assuming the following approximations:
	\begin{equation}
	\ddot{\vec{U}}\simeq \frac{1}{\Delta t^2} \left(\vec{u}_{t+\Delta t} - 2\,\vec{u}_t + \vec{u}_{t-\Delta t}\right) \label{eq:central_scheme}
	\end{equation}
	\begin{equation}
	\dot{\vec{U}}\simeq \frac{\vec{u}_{t+\Delta t} -\vec{u}_{t-\Delta t}}{2 \Delta t}
	\label{eq:first_derivative_scheme}
	\end{equation}
	and substituting eq.~\ref{eq:central_scheme}-\ref{eq:first_derivative_scheme} into eq.~\ref{eq:motion} leads to:
	\begin{equation}
	\begin{split}
	\underbrace{\left(\frac{1}{\Delta t^2} \,\bm{M} + \frac{1}{2 \Delta t} \bm{C}\right)}_{\vec{M}_0} \vec{u}_{t+\Delta t} &= \vec{F}_t - \underbrace{\left(\bm{K} \vec{u}_t\right)}_{\vec{F}^i} + \underbrace{\left(\frac{2}{\Delta t^2} \,\bm{M} \right)}_{\vec{M}_1}\vec{u}_t \\
	&+ \underbrace{\left(- \frac{1}{\Delta t^2} \,\bm{M} + \frac{1}{2 \Delta t} \bm{C}\right)}_{\vec{M}_2} \vec{u}_{t-\Delta t}.
	\label{eq:explicit_integration}
	\end{split}
	\end{equation}
	The advantage of the spectral element method over finite element method is that the mass matrix is diagonal. It has been shown [] that for the Lamb wave attenuation modelling it is possible to assume that the damping matrix is proportional to mass matrix. In such case calculation of displacements at the time step $t + \Delta t$ is straightforward and does not require costly matrix inversion. However, the term $\vec{F}^i=\bm{K}\vec{u}_t$ related to internal forces at the time step $t$ is still computationally intensive. Moreover, assembly of the stiffness matrix is troublesome because it requires a lot of memory and limits the size of wave propagation problem which can be simulated. In order to alleviate these deficiencies, parallel code is proposed in which assembly is performed at the internal force vector level without necessity of stiffness matrix assembly. The proposed approach is very similar to the parallel implementation given in []. However, due to analytic integration over thickness and more complex displacement field in comparison to 3D solid spectral elements, the process of calculation of $\vec{F}^i=\bm{K}\vec{u}_t$ term is a little bit different and it is divided into two steps. In the first step stress-like components are calculated at the time moment $t$ (index $t$ in displacement vectors is omitted for clarity):
	\begin{equation}
	\begin{split}
	\bs{\sigma}_{xx}&=\left((\bm{N},_{\xi}\vec{U}_x).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\vec{U}_x).*(\vec{J}^{-1})_{21}\right).*\vec{A}_{11}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_x).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\bs{\Phi}_x).*(\vec{J}^{-1})_{21}\right).*\vec{B}_{11}\\
	&+\left((\bm{N},_{\xi}\vec{U}_y).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\vec{U}_y).*(\vec{J}^{-1})_{22}\right).*\vec{A}_{12}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_y).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\bs{\Phi}_y).*(\vec{J}^{-1})_{22}\right).*\vec{B}_{12}\\
	&+\left((\bm{N},_{\xi}\vec{U}_x).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\vec{U}_x).*(\vec{J}^{-1})_{22}\right).*\vec{A}_{16}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_x).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\bs{\Phi}_x).*(\vec{J}^{-1})_{22}\right).*\vec{B}_{16}\\
	&+\left((\bm{N},_{\xi}\vec{U}_y).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\vec{U}_y).*(\vec{J}^{-1})_{21}\right).*\vec{A}_{16}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_y).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\bs{\Phi}_y).*(\vec{J}^{-1})_{21}\right).*\vec{B}_{16},
	\end{split}
	\end{equation}
	\begin{equation}
	\begin{split}
	\bs{\sigma}_{xxz}&=\left((\bm{N},_{\xi}\vec{U}_x).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\vec{U}_x).*(\vec{J}^{-1})_{21}\right).*\vec{B}_{11}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_x).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\bs{\Phi}_x).*(\vec{J}^{-1})_{21}\right).*\vec{D}_{11}\\
	&+\left((\bm{N},_{\xi}\vec{U}_y).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\vec{U}_y).*(\vec{J}^{-1})_{22}\right).*\vec{B}_{12}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_y).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\bs{\Phi}_y).*(\vec{J}^{-1})_{22}\right).*\vec{D}_{12}\\
	&+\left((\bm{N},_{\xi}\vec{U}_x).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\vec{U}_x).*(\vec{J}^{-1})_{22}\right).*\vec{B}_{16}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_x).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\bs{\Phi}_x).*(\vec{J}^{-1})_{22}\right).*\vec{D}_{16}\\
	&+\left((\bm{N},_{\xi}\vec{U}_y).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\vec{U}_y).*(\vec{J}^{-1})_{21}\right).*\vec{B}_{16}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_y).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\bs{\Phi}_y).*(\vec{J}^{-1})_{21}\right).*\vec{D}_{16},
	\end{split}
	\end{equation}
	\begin{equation}
	\begin{split}
	\bs{\sigma}_{xy}&=\left((\bm{N},_{\xi}\vec{U}_x).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\vec{U}_x).*(\vec{J}^{-1})_{21}\right).*\vec{A}_{16}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_x).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\bs{\Phi}_x).*(\vec{J}^{-1})_{21}\right).*\vec{B}_{16}\\
	&+\left((\bm{N},_{\xi}\vec{U}_y).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\vec{U}_y).*(\vec{J}^{-1})_{22}\right).*\vec{A}_{26}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_y).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\bs{\Phi}_y).*(\vec{J}^{-1})_{22}\right).*\vec{B}_{26}\\
	&+\left((\bm{N},_{\xi}\vec{U}_x).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\vec{U}_x).*(\vec{J}^{-1})_{22}\right).*\vec{A}_{66}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_x).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\bs{\Phi}_x).*(\vec{J}^{-1})_{22}\right).*\vec{B}_{66}\\
	&+\left((\bm{N},_{\xi}\vec{U}_y).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\vec{U}_y).*(\vec{J}^{-1})_{21}\right).*\vec{A}_{66}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_y).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\bs{\Phi}_y).*(\vec{J}^{-1})_{21}\right).*\vec{B}_{66},
	\end{split}
	\end{equation}
	\begin{equation}
	\begin{split}
	\bs{\sigma}_{xyz}&=\left((\bm{N},_{\xi}\vec{U}_x).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\vec{U}_x).*(\vec{J}^{-1})_{21}\right).*\vec{B}_{16}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_x).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\bs{\Phi}_x).*(\vec{J}^{-1})_{21}\right).*\vec{D}_{16}\\
	&+\left((\bm{N},_{\xi}\vec{U}_y).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\vec{U}_y).*(\vec{J}^{-1})_{22}\right).*\vec{B}_{26}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_y).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\bs{\Phi}_y).*(\vec{J}^{-1})_{22}\right).*\vec{D}_{26}\\
	&+\left((\bm{N},_{\xi}\vec{U}_x).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\vec{U}_x).*(\vec{J}^{-1})_{22}\right).*\vec{B}
	_{66}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_x).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\bs{\Phi}_x).*(\vec{J}^{-1})_{22}\right).*\vec{D}_{66}\\
	&+\left((\bm{N},_{\xi}\vec{U}_y).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\vec{U}_y).*(\vec{J}^{-1})_{21}\right).*\vec{B}_{66}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_y).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\bs{\Phi}_y).*(\vec{J}^{-1})_{21}\right).*\vec{D}_{66},
	\end{split}
	\end{equation}
	\begin{equation}
	\begin{split}
	\bs{\sigma}_{yy}&=\left((\bm{N},_{\xi}\vec{U}_x).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\vec{U}_x).*(\vec{J}^{-1})_{21}\right).*\vec{A}_{12}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_x).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\bs{\Phi}_x).*(\vec{J}^{-1})_{21}\right).*\vec{B}_{12}\\
	&+\left((\bm{N},_{\xi}\vec{U}_y).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\vec{U}_y).*(\vec{J}^{-1})_{22}\right).*\vec{A}_{22}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_y).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\bs{\Phi}_y).*(\vec{J}^{-1})_{22}\right).*\vec{B}_{22}\\
	&+\left((\bm{N},_{\xi}\vec{U}_x).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\vec{U}_x).*(\vec{J}^{-1})_{22}\right).*\vec{A}_{26}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_x).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\bs{\Phi}_x).*(\vec{J}^{-1})_{22}\right).*\vec{B}_{26}\\
	&+\left((\bm{N},_{\xi}\vec{U}_y).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\vec{U}_y).*(\vec{J}^{-1})_{21}\right).*\vec{A}_{26}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_y).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\bs{\Phi}_y).*(\vec{J}^{-1})_{21}\right).*\vec{B}_{26},
	\end{split}
	\end{equation}
	\begin{equation}
	\begin{split}
	\bs{\sigma}_{yyz}&=\left((\bm{N},_{\xi}\vec{U}_x).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\vec{U}_x).*(\vec{J}^{-1})_{21}\right).*\vec{B}_{12}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_x).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\bs{\Phi}_x).*(\vec{J}^{-1})_{21}\right).*\vec{D}_{12}\\
	&+\left((\bm{N},_{\xi}\vec{U}_y).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\vec{U}_y).*(\vec{J}^{-1})_{22}\right).*\vec{B}_{22}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_y).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\bs{\Phi}_y).*(\vec{J}^{-1})_{22}\right).*\vec{D}_{22}\\
	&+\left((\bm{N},_{\xi}\vec{U}_x).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\vec{U}_x).*(\vec{J}^{-1})_{22}\right).*\vec{B}_{26}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_x).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\bs{\Phi}_x).*(\vec{J}^{-1})_{22}\right).*\vec{D}_{26}\\
	&+\left((\bm{N},_{\xi}\vec{U}_y).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\vec{U}_y).*(\vec{J}^{-1})_{21}\right).*\vec{B}_{26}\\
	&+\left((\bm{N},_{\xi}\bs{\Phi}_y).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\bs{\Phi}_y).*(\vec{J}^{-1})_{21}\right).*\vec{D}_{26},
	\end{split}
	\end{equation}
	\begin{equation}
	\begin{split}
	\bs{\sigma}_{yz}&=\left(\bs{\Phi}_y+(\bm{N},_{\xi}\vec{U}_z).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\vec{U}_z).*(\vec{J}^{-1})_{22}\right).*\vec{A}_{44}\\
	&+\left(\bs{\Phi}_x+(\bm{N},_{\xi}\vec{U}_z).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\vec{U}_z).*(\vec{J}^{-1})_{21}\right).*\vec{A}_{45},\\
	\bs{\sigma}_{xz}&=\left(\bs{\Phi}_y+(\bm{N},_{\xi}\vec{U}_z).*(\vec{J}^{-1})_{12}+(\bm{N},_{\eta}\vec{U}_z).*(\vec{J}^{-1})_{22}\right).*\vec{A}_{45}\\
	&+\left(\bs{\Phi}_x+(\bm{N},_{\xi}\vec{U}_z).*(\vec{J}^{-1})_{11}+(\bm{N},_{\eta}\vec{U}_z).*(\vec{J}^{-1})_{21}\right).*\vec{A}_{55},
	\end{split}
	\end{equation}
	where $.*$ denotes element-wise operation known as Hadamarad product (the same symbol for element-wise operation is used in Matlab). It should be noted that $\vec{A}$, $\vec{B}$, $\vec{D}$ and $(\vec{J}^{-1})$ with appropriate indexes are arranged in the form of vectors respective to GLL nodes of consecutive disjoint spectral elements. The same rules of disjoint arrangement are applied for nodal displacements:
	\begin{equation}
	\vec{U}_x = \left[
	\begin{array}{c}  
	\hat{\vec{u}}_0^{e=1}  \\[2pt]
	\hat{\vec{u}}_0^{e=2} \\[2pt]
	\vdots\\[2pt]
	\hat{\vec{u}}_0^{e=n}\\[2pt]
	\end{array}\right],
	\quad
	\vec{U}_y = \left[
	\begin{array}{c}  
	\hat{\vec{v}}_0^{e=1}  \\[2pt]
	\hat{\vec{v}}_0^{e=2} \\[2pt]
	\vdots\\[2pt]
	\hat{\vec{v}}_0^{e=n}\\[2pt]
	\end{array}\right],
	\quad
	\vec{U}_z = \left[
	\begin{array}{c}  
	\hat{\vec{w}}_0^{e=1}  \\[2pt]
	\hat{\vec{w}}_0^{e=2} \\[2pt]
	\vdots\\[2pt]
	\hat{\vec{w}}_0^{e=n}\\[2pt]
	\end{array}\right],
	\end{equation}
	\begin{equation}
	\bs{\Phi}_x = \left[
	\begin{array}{c}  
	\hat{\bs{\varphi}}_x^{e=1}  \\[2pt]
	\hat{\bs{\varphi}}_x^{e=2} \\[2pt]
	\vdots\\[2pt]
	\hat{\bs{\varphi}}_x^{e=n}\\[2pt]
	\end{array}\right],
	\quad
	\bs{\Phi}_y = \left[
	\begin{array}{c}  
	\hat{\bs{\varphi}}_y^{e=1}  \\[2pt]
	\hat{\bs{\varphi}}_y^{e=2} \\[2pt]
	\vdots\\[2pt]
	\hat{\bs{\varphi}}_y^{e=n}\\[2pt]
	\end{array}\right],
	\end{equation}
	where $n$ is the total number of elements in the spectral element mesh. Sparse matrices of shape function derivatives are formed in similar way, i.e.:
	\begin{equation}
	\bm{N},_{\xi} = \left[
	\begin{array}{cccc}  
		\bm{N},_{\xi}^{e=1} & 0 & \ldots & 0\\[2pt]
		0& \bm{N},_{\xi}^{e=2}  & \ldots& 0\\[2pt]
		\vdots&\vdots&\ddots&0\\[2pt]
		0& 0 &0&\bm{N},_{\xi}^{e=n}\\[2pt]
	\end{array}\right].
	\end{equation}
	In the second step internal forces are calculated on the degree of freedom level: 
	\begin{equation}
	\begin{split}
	\vec{F}_u^i&=\bm{N},_{\xi}^T \left(\bs{\sigma}_{xx}\,.*(\vec{J}^{-1})_{11}\,.*\vec{W}\right)+\bm{N},_{\eta}^T \left(\bs{\sigma}_{xx}\,.*(\vec{J}^{-1})_{21}\,.*\vec{W}\right)\\
	&+\bm{N},_{\xi}^T \left(\bs{\sigma}_{xy}\,.*(\vec{J}^{-1})_{12}\,.*\vec{W}\right)+\bm{N},_{\eta}^T \left(\bs{\sigma}_{xy}\,.*(\vec{J}^{-1})_{22}\,.*\vec{W}\right), \\ 
	\vec{F}_v^i&=\bm{N},_{\xi}^T \left(\bs{\sigma}_{yy}\,.*(\vec{J}^{-1})_{12}\,.*\vec{W}\right)+\bm{N},_{\eta}^T \left(\bs{\sigma}_{yy}\,.*(\vec{J}^{-1})_{22}\,.*\vec{W}\right)\\
	&+\bm{N},_{\xi}^T \left(\bs{\sigma}_{xy}\,.*(\vec{J}^{-1})_{11}\,.*\vec{W}\right)+\bm{N},_{\eta}^T \left(\bs{\sigma}_{xy}\,.*(\vec{J}^{-1})_{21}\,.*\vec{W}\right),\\
	\vec{F}_w^i&=\bm{N},_{\xi}^T \left(\bs{\sigma}_{yz}\,.*(\vec{J}^{-1})_{12}\,.*\vec{W}\right)+\bm{N},_{\eta}^T \left(\bs{\sigma}_{yz}\,.*(\vec{J}^{-1})_{22}\,.*\vec{W}\right)\\
	& +\bm{N},_{\xi}^T \left(\bs{\sigma}_{xz}\,.*(\vec{J}^{-1})_{11}\,.*\vec{W}\right)+\bm{N},_{\eta}^T \left(\bs{\sigma}_{xz}\,.*(\vec{J}^{-1})_{21}\,.*\vec{W}\right),\\
	\vec{M}_x^i&=\bm{N},_{\xi}^T \left(\bs{\sigma}_{xxz}\,.*(\vec{J}^{-1})_{11}\,.*\vec{W}\right)+\bm{N},_{\eta}^T \left(\bs{\sigma}_{xxz}\,.*(\vec{J}^{-1})_{21}\,.*\vec{W}\right)\\
	&+\bm{N},_{\xi}^T \left(\bs{\sigma}_{xyz}\,.*(\vec{J}^{-1})_{12}\,.*\vec{W}\right)+\bm{N},_{\eta}^T \left(\bs{\sigma}_{xyz}\,.*(\vec{J}^{-1})_{22}\,.*\vec{W}\right)\\
	&+\bs{\sigma}_{xz}\,.*\vec{W},\\
	\vec{M}_y^i&=\bm{N},_{\xi}^T \left(\bs{\sigma}_{yyz}\,.*(\vec{J}^{-1})_{12}\,.*\vec{W}\right)+\bm{N},_{\eta}^T \left(\bs{\sigma}_{yyz}\,.*(\vec{J}^{-1})_{22}\,.*\vec{W}\right)\\
	&+\bm{N},_{\xi}^T \left(\bs{\sigma}_{xyz}\,.*(\vec{J}^{-1})_{11}\,.*\vec{W}\right)+\bm{N},_{\eta}^T \left(\bs{\sigma}_{xyz}\,.*(\vec{J}^{-1})_{21}\,.*\vec{W}\right)\\
	&+\bs{\sigma}_{yz}\,.*\vec{W},
	\label{eq:internal_forces}
	\end{split}
	\end{equation}
	where $^T$ is the matrix transpose and $\vec{W}$ is the vector resulting from multiplication of integration weights and determinant of Jacobian matrix at appropriate GLL points:
	\begin{equation}
	\vec{W} = \vec{w}_{\xi}\,.*\vec{w}_{\eta}\,.*\left(\det\vec{J}\right)
	\end{equation}
	Since internal forces are calculated for disjoined spectral elements, assembly of global vector $\vec{F}^i$ is necessary. It can be performed according to mesh colouring algorithm proposed in []. The algorithm uniformly divides nodes of spectral elements within the whole mesh into 12 sets. Because each flat shell spectral element consists of 36 nodes, the 12 sets are of the same size so the computation can be perfectly balanced between workers or resources can be uniformly divided within one GPU card.
	
	Once internal forces $\vec{F}^i$ are calculated and substituted into eq.~\ref{eq:explicit_integration}, the displacements at time step $t+\Delta t$ can be explicitly obtained from perfectly vectorized code:
	\begin{equation}
	\vec{u}_{t+\Delta t}=1/\vec{M}_0\, .*\left(\vec{F}_t - \vec{F}^i +\vec{M}_1 \, .* \vec{u}_t +\vec{M}_2 \, .* \vec{u}_{t-\Delta t}\right),
	\label{eq:vectorized_motion}
	\end{equation} 
	in which terms $\vec{M}_0$, $\vec{M}_1$ and $\vec{M}_2$ are stored as vectors. In particular all components in eq.~\ref{eq:internal_forces} as well as in eq.~\ref{eq:vectorized_motion} are implemented in Matlab Parallel Computing Toolbox as \verb|gpuArray|. In this way, implementation is simple whereas CUDA GPU computation is transparent to the user.
	% mention about computation speed-up
	\section{Interpolation on uniform grid}
	With the advent of laser vibrometry technique, many damage visualisation algorithms are developed in which full wavefield data is used. Such algorithms can be tested also on synthetic data for easy of efficacy comparison. However, the mesh of spectral elements is usually unstructured due to analysed features such as delamination as well as piezoelectric transducers. Moreover, the nodes of spectral elements are non-uniformly distributed and correspond to GLL points. It makes difficult to apply damage visualisation algorithms for such numerically simulated wavefields, especially when Fourier transforms are required and in turn grid of spatial points must be uniform. For this reason, interpolation technique of spectral element wavefield on uniform grid of points on top or bottom surface of the shell has been developed.
	\section{Experimental validation}
	\section{Exemplary applications}
	\section{Conclusions}
	
	%% The Appendices part is started with the command \appendix;
	%% appendix sections are then done as normal sections
	%% \appendix
	%% \section{}
	%% \label{}
	\section*{Acknowledgement}
	The first author would like to acknowledge the Polish National Agency for Academic Exchange for the support in the frame of the Bekker Programme (PPN/BEK/2018/1/00014/DEC/1). The research was partially funded by the Polish National Science Center under grant agreement no 2018/31/B/ST8/00454. The authors are also grateful to Task-CI for allowing the use of Matlab and Parallel Computing Toolbox licenses. 
	
	
	
	%% If you have bibdatabase file and want bibtex to generate the
	%% bibitems, please use
	%%
	%%  \bibliographystyle{elsarticle-harv} 
	%%  \bibliography{<your bibdatabase>}
	
	%% else use the following coding to input the bibitems directly in the
	%% TeX file.
	\section*{Reference}
	\bibliography{BibTeX_interface}{}
	\bibliographystyle{num_order}
\end{document}


