function [a11,a12,a13,a16,a22,a23,a33,a26,a36,a44,a45,a55,a66,J0]=composite3D_transf_C(h,h1,h2,rho,q11,q12,q13,q22,q23,q33,q44,q55,q66,alpha,lay)


if (length(q11)<lay)
    q11=repmat(q11,lay,1);
    q12=repmat(q12,lay,1);
    q13=repmat(q13,lay,1);
    q22=repmat(q22,lay,1);
    q23=repmat(q23,lay,1);
    q33=repmat(q33,lay,1);
    q44=repmat(q44,lay,1);
    q55=repmat(q55,lay,1);
    q66=repmat(q66,lay,1);
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% global single layer properties 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
alphar=alpha*pi/180; m=cos(alphar); n=sin(alphar);
for k=1:lay
    if(abs(m(k))<eps) m(k)=0;end
    if(abs(n(k))<eps) n(k)=0;end
end
% elastic properties %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

s11=q11.*m.^4+2*(q12+2*q66).*m.^2.*n.^2+q22.*n.^4;
s12=(q11+q22-4*q66).*m.^2.*n.^2+q12.*(m.^4+n.^4);
s13=q13.*m.^2 +q23.*n.^2;
s16=(q11-q12-2*q66).*m.^3.*n+(q12-q22+2*q66).*m.*n.^3;
s22=q11.*n.^4+2*(q12+2*q66).*m.^2.*n.^2+q22.*m.^4;
s23=n.^2.*q13 + m.^2.*q23;
s33=q33;
s26=(q11-q12-2*q66).*n.^3.*m+(q12-q22+2*q66).*n.*m.^3;
s36=(q13-q23).*m.*n;
s44=q44.*m.^2 + q55.*n.^2;
s45=(q55-q44).*m.*n;
s55=q55.*m.^2 + q44.*n.^2;
s66=(q11+q22-2*q12-2*q66).*m.^2.*n.^2+q66.*(m.^4+n.^4);


        J0=0; 
        a11=0; a12=0; a13=0; a16=0; a22=0; a23=0; a33=0; a26=0; a36=0; a44=0; a45=0; a55=0; a66=0; 
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        % global multilayer properties
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        for i=1:lay;
            % mass matrix components %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
            J0=J0+rho(i)*(h2(i)-h1(i))/h;
            % stiffness matrix components %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
            a11=a11+s11(i)*(h2(i)-h1(i))/h;
            a12=a12+s12(i)*(h2(i)-h1(i))/h;
            a13=a13+s13(i)*(h2(i)-h1(i))/h;
            a16=a16+s16(i)*(h2(i)-h1(i))/h;
            a22=a22+s22(i)*(h2(i)-h1(i))/h;
            a23=a23+s23(i)*(h2(i)-h1(i))/h;
            a33=a33+s33(i)*(h2(i)-h1(i))/h;
            a26=a26+s26(i)*(h2(i)-h1(i))/h;
            a36=a36+s36(i)*(h2(i)-h1(i))/h;
            a44=a44+s44(i)*(h2(i)-h1(i))/h;
            a45=a45+s45(i)*(h2(i)-h1(i))/h;
            a55=a55+s55(i)*(h2(i)-h1(i))/h;
            a66=a66+s66(i)*(h2(i)-h1(i))/h;
        end;
        
    

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% End of composite3D_transf_C.m
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%